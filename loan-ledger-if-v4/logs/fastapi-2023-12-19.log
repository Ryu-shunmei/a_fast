2023-12-19 11:03:50.548 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 11:05:12.692 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:52640 - "OPTIONS /token HTTP/1.1" 200
2023-12-19 11:05:12.712 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 11:05:12.723 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 11:05:12.726 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 11:05:12.728 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 11:05:12.733 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 11:05:12.740 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:52640 - "POST /token HTTP/1.1" 200
2023-12-19 12:51:23.702 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:56481 - "OPTIONS /token HTTP/1.1" 200
2023-12-19 12:51:23.723 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 12:51:23.728 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:51:23.731 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:51:23.732 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:51:23.739 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 12:51:23.744 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:56481 - "POST /token HTTP/1.1" 200
2023-12-19 12:52:21.458 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 12:52:21.461 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:52:21.463 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:52:21.467 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:52:21.474 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 12:52:21.478 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:56737 - "POST /token HTTP/1.1" 200
2023-12-19 12:55:12.555 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 12:55:12.560 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:55:12.567 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:55:12.574 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:55:12.578 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 12:55:12.584 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:57441 - "POST /token HTTP/1.1" 200
2023-12-19 12:56:09.981 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 12:56:09.986 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:56:09.990 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:56:09.991 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 12:56:10.006 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 12:56:10.017 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:57687 - "POST /token HTTP/1.1" 200
2023-12-19 13:39:17.231 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:52078 - "OPTIONS /token HTTP/1.1" 200
2023-12-19 13:39:17.245 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 13:39:17.249 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:39:17.253 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:39:17.255 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:39:17.260 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 13:39:17.272 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:52078 - "POST /token HTTP/1.1" 200
2023-12-19 13:42:36.271 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 13:42:36.275 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:42:36.279 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:42:36.281 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 13:42:36.283 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 13:42:36.290 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:52905 - "POST /token HTTP/1.1" 200
2023-12-19 15:26:34.894 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62178 - "GET /orgs HTTP/1.1" 404
2023-12-19 15:27:04.479 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT orgs.* FROM orgs WHERE id = '30be4968-c0a5-41d1-8d94-b8aa18e46dc3'
        union
        SELECT child.* FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 15:27:04.489 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62301 - "GET /test HTTP/1.1" 200
2023-12-19 15:27:48.339 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 15:27:48.442 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 15:27:48.442 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 15:27:48.443 | INFO     | uvicorn.server:serve:86 - Finished server process [19746]
2023-12-19 15:27:48.935 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 15:27:58.320 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT orgs.* FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        union
        SELECT child.* FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 15:27:58.336 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62528 - "GET /test HTTP/1.1" 200
2023-12-19 15:31:39.316 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 15:31:39.418 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 15:31:39.419 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 15:31:39.420 | INFO     | uvicorn.server:serve:86 - Finished server process [24587]
2023-12-19 15:31:39.873 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 15:32:17.595 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 15:32:17.697 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 15:32:17.698 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 15:32:17.698 | INFO     | uvicorn.server:serve:86 - Finished server process [24645]
2023-12-19 15:32:18.086 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 15:32:25.879 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT orgs.* FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        union
        SELECT child.* FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 15:32:25.888 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:63615 - "GET /test HTTP/1.1" 200
2023-12-19 15:35:15.647 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 15:35:15.750 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 15:35:15.750 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 15:35:15.751 | INFO     | uvicorn.server:serve:86 - Finished server process [24677]
2023-12-19 15:35:16.196 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 15:35:20.472 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT orgs.* FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        union
        SELECT child.* FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 15:35:20.491 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64332 - "GET /test HTTP/1.1" 200
2023-12-19 16:02:54.576 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:02:54.678 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:02:54.679 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:02:54.679 | INFO     | uvicorn.server:serve:86 - Finished server process [24779]
2023-12-19 16:02:55.158 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:05:56.945 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:05:57.048 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:05:57.049 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:05:57.049 | INFO     | uvicorn.server:serve:86 - Finished server process [25200]
2023-12-19 16:05:57.504 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:17:49.257 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:17:49.361 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:17:49.362 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:17:49.362 | INFO     | uvicorn.server:serve:86 - Finished server process [25248]
2023-12-19 16:17:49.851 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:17:54.602 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:17:54.655 | ERROR    | app.endpoints.master:bank_types:72 - 'NoneType' object has no attribute 'update'Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102af99d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10289f430>
           └ <SpawnProcess name='SpawnProcess-86' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102893a60>
    └ <SpawnProcess name='SpawnProcess-86' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x102ad5b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-86' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-86' parent=96543 started>
    │    └ <function subprocess_started at 0x106542790>
    └ <SpawnProcess name='SpawnProcess-86' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x102ad5f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x106536d30>
           │       │   └ <uvicorn.server.Server object at 0x102ad5f70>
           │       └ <function run at 0x102b4b790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x106540140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10658f880>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10666c370>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10658f880>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10667b7c0>
          └ <fastapi.applications.FastAPI object at 0x10666c370>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1066714c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10667b760>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10667b7c0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1066714c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10667b730>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10667b760>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1066713a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10667b6d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10667b730>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1066713a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10666c490>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10667b6d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1066713a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105b4e940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1066713a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10666c1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x106676790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10666c9d0>
                     └ <function get_request_handler.<locals>.app at 0x106676700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105b2e5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x106556a00>}
                 │         └ <function bank_types at 0x106014160>
                 └ <fastapi.dependencies.models.Dependant object at 0x106678cd0>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 69, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': ['7a756ca8-83ca-47a...
            └ <function list_to_tree at 0x106009b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 7, in list_to_tree
    res.setdefault(v["id"]).update(v)
    │   │          │               └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': ['7a756ca8-83ca-47aa...
    │   │          └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': ['7a756ca8-83ca-47aa...
    │   └ <method 'setdefault' of 'dict' objects>
    └ {'7a756ca8-83ca-47aa-96f0-385bc82ba7af': None}

AttributeError: 'NoneType' object has no attribute 'update'

2023-12-19 16:17:54.678 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58518 - "GET /test HTTP/1.1" 500
2023-12-19 16:19:17.788 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:19:17.891 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:19:17.892 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:19:17.892 | INFO     | uvicorn.server:serve:86 - Finished server process [25464]
2023-12-19 16:19:18.345 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:19:25.550 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:19:25.587 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:19:25.588 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58887 - "GET /test HTTP/1.1" 200
2023-12-19 16:20:06.222 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:20:06.323 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:20:06.324 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:20:06.325 | INFO     | uvicorn.server:serve:86 - Finished server process [25494]
2023-12-19 16:20:06.774 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:20:27.121 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:20:27.223 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:20:27.223 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:20:27.224 | INFO     | uvicorn.server:serve:86 - Finished server process [25517]
2023-12-19 16:20:27.589 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:21:22.393 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:21:22.495 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:21:22.496 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:21:22.497 | INFO     | uvicorn.server:serve:86 - Finished server process [25537]
2023-12-19 16:21:22.960 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:21:26.720 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:21:26.760 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:59442 - "GET /test HTTP/1.1" 200
2023-12-19 16:23:42.711 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:23:42.813 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:23:42.813 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:23:42.813 | INFO     | uvicorn.server:serve:86 - Finished server process [25569]
2023-12-19 16:23:43.272 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:23:57.821 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:23:57.866 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60519 - "GET /test HTTP/1.1" 200
2023-12-19 16:25:43.613 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:25:43.716 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:25:43.717 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:25:43.717 | INFO     | uvicorn.server:serve:86 - Finished server process [25664]
2023-12-19 16:25:44.194 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:25:51.339 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:25:51.357 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61200 - "GET /test HTTP/1.1" 200
2023-12-19 16:26:06.997 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:26:07.099 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:26:07.100 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:26:07.100 | INFO     | uvicorn.server:serve:86 - Finished server process [25708]
2023-12-19 16:26:07.587 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:26:31.737 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:26:31.772 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61388 - "GET /test HTTP/1.1" 200
2023-12-19 16:52:08.872 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:52:08.977 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:52:08.978 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:52:08.978 | INFO     | uvicorn.server:serve:86 - Finished server process [25737]
2023-12-19 16:52:09.446 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:52:12.967 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || parents.depth + 1, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:52:13.003 | ERROR    | app.endpoints.master:bank_types:72 - sequence item 0: expected str instance, int foundTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x10514d9d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104ecb430>
           └ <SpawnProcess name='SpawnProcess-94' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104ebfa60>
    └ <SpawnProcess name='SpawnProcess-94' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105129b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-94' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-94' parent=96543 started>
    │    └ <function subprocess_started at 0x1076c2790>
    └ <SpawnProcess name='SpawnProcess-94' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105129f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1076b6d30>
           │       │   └ <uvicorn.server.Server object at 0x105129f70>
           │       └ <function run at 0x10518b790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1076c00c0>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10770cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1077ea5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10770cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1077f9a30>
          └ <fastapi.applications.FastAPI object at 0x1077ea5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1077f04c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1077f99d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1077f9a30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1077f04c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1077f99a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1077f99d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1077f03a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1077f9940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1077f99a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1077f03a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1077ea700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1077f9940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1077f03a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106cde940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1077f03a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1077ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1077f6790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1077ea4c0>
                     └ <function get_request_handler.<locals>.app at 0x1077f6700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106cbe5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x1076d6c70>}
                 │         └ <function bank_types at 0x1071a6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1077f4f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 69, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}, {...
            └ <function list_to_tree at 0x107199b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 7, in list_to_tree
    res.setdefault(v["id"], {**v, "key": "/".join(v["key"])}
    │   │          │           │                  └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          │           └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   └ <method 'setdefault' of 'dict' objects>
    └ {}

TypeError: sequence item 0: expected str instance, int found

2023-12-19 16:52:13.019 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:53019 - "GET /test HTTP/1.1" 500
2023-12-19 16:53:11.634 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:53:11.736 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:53:11.736 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:53:11.736 | INFO     | uvicorn.server:serve:86 - Finished server process [26264]
2023-12-19 16:53:12.131 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:53:33.011 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:53:33.112 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:53:33.114 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:53:33.114 | INFO     | uvicorn.server:serve:86 - Finished server process [26287]
2023-12-19 16:53:33.543 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:53:35.440 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, ARRAY[0] AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:53:35.447 | ERROR    | app.endpoints.master:bank_types:72 - operator does not exist: integer[] + integer
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102f959d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102d13430>
           └ <SpawnProcess name='SpawnProcess-96' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102d07a60>
    └ <SpawnProcess name='SpawnProcess-96' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x102f71b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-96' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-96' parent=96543 started>
    │    └ <function subprocess_started at 0x1053ee790>
    └ <SpawnProcess name='SpawnProcess-96' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x102f71f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1053e3d30>
           │       │   └ <uvicorn.server.Server object at 0x102f71f70>
           │       └ <function run at 0x102fd3790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1053ec0c0>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105438fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105516130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1055165e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105438fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105516130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105516130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105526a30>
          └ <fastapi.applications.FastAPI object at 0x1055165e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1055194c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1055269d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105526a30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1055194c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1055269a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1055269d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055193a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105526940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1055269a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055193a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x105516700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105526940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055193a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104b26940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055193a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x105522790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1055164c0>
                     └ <function get_request_handler.<locals>.app at 0x105522700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104b065e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x105402c70>}
                 │         └ <function bank_types at 0x104fed160>
                 └ <fastapi.dependencies.models.Dependant object at 0x105520f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 66, in bank_types
    data = await common.query_access_orgs(db, "7a756ca8-83ca-47aa-96f0-385bc82ba7af")
                 │      │                 └ <providers.psql_provider.DB object at 0x105402c70>
                 │      └ <function query_access_orgs at 0x104fe1940>
                 └ <module 'app.crud.common' from '/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py'>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py", line 28, in query_access_orgs
    return await db.fetch_all(sql)
                 │  │         └ "\n    WITH RECURSIVE parents AS (\n        SELECT id, type, name, parent_id, ARRAY[id] AS key, ARRAY[0] AS depth FROM orgs W...
                 │  └ <function DB.fetch_all at 0x104fcdb80>
                 └ <providers.psql_provider.DB object at 0x105402c70>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/providers/psql_provider.py", line 40, in fetch_all
    result = await con.fetch(query)
                   │   │     └ "\n    WITH RECURSIVE parents AS (\n        SELECT id, type, name, parent_id, ARRAY[id] AS key, ARRAY[0] AS depth FROM orgs W...
                   │   └ <function Connection.fetch at 0x104d29ee0>
                   └ <PoolConnectionProxy [released] 0x105526c40>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
                 │    └ <function Connection._execute at 0x104d1e040>
                 └ <asyncpg.connection.Connection object at 0x1056435e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                      └ <asyncpg.connection.Connection object at 0x1056435e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                         │    └ <function Connection._do_execute at 0x104d1e430>
                         └ <asyncpg.connection.Connection object at 0x1056435e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
                 │    └ <function Connection._get_statement at 0x104d1b550>
                 └ <asyncpg.connection.Connection object at 0x1056435e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                      │    └ <member '_protocol' of 'Connection' objects>
                      └ <asyncpg.connection.Connection object at 0x1056435e0>
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
    return await waiter

asyncpg.exceptions.UndefinedFunctionError: operator does not exist: integer[] + integer
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2023-12-19 16:53:35.475 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:53372 - "GET /test HTTP/1.1" 500
2023-12-19 16:54:12.931 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 16:54:13.033 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 16:54:13.034 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 16:54:13.034 | INFO     | uvicorn.server:serve:86 - Finished server process [26300]
2023-12-19 16:54:13.447 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 16:54:15.643 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 16:54:15.671 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:53542 - "GET /test HTTP/1.1" 200
2023-12-19 17:07:59.372 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:07:59.476 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:07:59.478 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:07:59.479 | INFO     | uvicorn.server:serve:86 - Finished server process [26317]
2023-12-19 17:07:59.986 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:08:05.651 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, array_append(key, array_length(key, 1)), parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:08:05.681 | ERROR    | app.endpoints.master:bank_types:72 - sequence item 0: expected str instance, int foundTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1012659d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100fe3430>
           └ <SpawnProcess name='SpawnProcess-98' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100fd7a60>
    └ <SpawnProcess name='SpawnProcess-98' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101241b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-98' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-98' parent=96543 started>
    │    └ <function subprocess_started at 0x1036be790>
    └ <SpawnProcess name='SpawnProcess-98' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101241f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1036b2d30>
           │       │   └ <uvicorn.server.Server object at 0x101241f70>
           │       └ <function run at 0x1012a3790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1036bc0c0>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10370bfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e6130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1037e65e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10370bfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e6130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e6130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1037f5a30>
          └ <fastapi.applications.FastAPI object at 0x1037e65e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1037eb4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1037f59d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1037f5a30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1037eb4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1037f59a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1037f59d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1037eb3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1037f5940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1037f59a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1037eb3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1037e6700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1037f5940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1037eb3a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102df6940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1037eb3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1037e61...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1037f2790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1037e64c0>
                     └ <function get_request_handler.<locals>.app at 0x1037f2700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102dd65e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x1036d1c70>}
                 │         └ <function bank_types at 0x1032be160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1037f0f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 69, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}, {...
            └ <function list_to_tree at 0x1032b1b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 7, in list_to_tree
    res.setdefault(v["id"], {**v, "key": "/".join(v["key"])}
    │   │          │           │                  └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          │           └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   └ <method 'setdefault' of 'dict' objects>
    └ {}

TypeError: sequence item 0: expected str instance, int found

2023-12-19 17:08:05.702 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58185 - "GET /test HTTP/1.1" 500
2023-12-19 17:08:33.224 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:08:33.326 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:08:33.326 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:08:33.326 | INFO     | uvicorn.server:serve:86 - Finished server process [26622]
2023-12-19 17:08:33.769 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:09:12.351 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:09:12.453 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:09:12.454 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:09:12.454 | INFO     | uvicorn.server:serve:86 - Finished server process [26643]
2023-12-19 17:09:12.924 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:09:15.011 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0,] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, array_append(key, array_length(key, 1)) as key, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:09:15.014 | ERROR    | app.endpoints.master:bank_types:73 - syntax error at or near "]"Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1032a19d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10301f430>
           └ <SpawnProcess name='SpawnProcess-100' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103013a60>
    └ <SpawnProcess name='SpawnProcess-100' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x10327db20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-100' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-100' parent=96543 started>
    │    └ <function subprocess_started at 0x105c43790>
    └ <SpawnProcess name='SpawnProcess-100' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10327df70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x105c37d30>
           │       │   └ <uvicorn.server.Server object at 0x10327df70>
           │       └ <function run at 0x1032df790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x105c410c0>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105c8cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105d6a5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105c8cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105d7aa30>
          └ <fastapi.applications.FastAPI object at 0x105d6a5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105d704c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x105d7a9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105d7aa30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105d704c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105d7a9a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x105d7a9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105d703a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105d7a940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105d7a9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105d703a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x105d6a700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105d7a940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105d703a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10504e940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105d703a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105d6a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x105d76790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105d6a4c0>
                     └ <function get_request_handler.<locals>.app at 0x105d76700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10502e5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x105c57c70>}
                 │         └ <function bank_types at 0x105716160>
                 └ <fastapi.dependencies.models.Dependant object at 0x105d74f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 66, in bank_types
    data = await common.query_access_orgs(db, "7a756ca8-83ca-47aa-96f0-385bc82ba7af")
                 │      │                 └ <providers.psql_provider.DB object at 0x105c57c70>
                 │      └ <function query_access_orgs at 0x105709940>
                 └ <module 'app.crud.common' from '/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py'>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py", line 28, in query_access_orgs
    return await db.fetch_all(sql)
                 │  │         └ "\n    WITH RECURSIVE parents AS (\n        SELECT id, type, name, parent_id, ARRAY[0,] AS key, 1 AS depth FROM orgs WHERE id...
                 │  └ <function DB.fetch_all at 0x1056f5af0>
                 └ <providers.psql_provider.DB object at 0x105c57c70>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/providers/psql_provider.py", line 40, in fetch_all
    result = await con.fetch(query)
                   │   │     └ "\n    WITH RECURSIVE parents AS (\n        SELECT id, type, name, parent_id, ARRAY[0,] AS key, 1 AS depth FROM orgs WHERE id...
                   │   └ <function Connection.fetch at 0x105451ee0>
                   └ <PoolConnectionProxy [released] 0x105d7ac40>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
                 │    └ <function Connection._execute at 0x105446040>
                 └ <asyncpg.connection.Connection object at 0x105e975e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                      └ <asyncpg.connection.Connection object at 0x105e975e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                         │    └ <function Connection._do_execute at 0x105446430>
                         └ <asyncpg.connection.Connection object at 0x105e975e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
                 │    └ <function Connection._get_statement at 0x105443550>
                 └ <asyncpg.connection.Connection object at 0x105e975e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                      │    └ <member '_protocol' of 'Connection' objects>
                      └ <asyncpg.connection.Connection object at 0x105e975e0>
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
    return await waiter

asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "]"

2023-12-19 17:09:15.039 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58511 - "GET /test HTTP/1.1" 500
2023-12-19 17:09:59.016 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:09:59.118 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:09:59.120 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:09:59.121 | INFO     | uvicorn.server:serve:86 - Finished server process [26658]
2023-12-19 17:09:59.515 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:10:03.373 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, array_append(key, array_length(key, 1)) as key, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:10:03.417 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58716 - "GET /test HTTP/1.1" 200
2023-12-19 17:11:54.771 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:11:54.874 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:11:54.874 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:11:54.875 | INFO     | uvicorn.server:serve:86 - Finished server process [26676]
2023-12-19 17:11:55.340 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:11:58.832 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, array_append(key, array_length(key, 1)) as key, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:11:58.864 | ERROR    | app.endpoints.master:bank_types:73 - sequence item 0: expected str instance, int foundTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102b319d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028af430>
           └ <SpawnProcess name='SpawnProcess-102' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028a3a60>
    └ <SpawnProcess name='SpawnProcess-102' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x102b0db20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-102' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-102' parent=96543 started>
    │    └ <function subprocess_started at 0x105497790>
    └ <SpawnProcess name='SpawnProcess-102' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x102b0df70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x10548bd30>
           │       │   └ <uvicorn.server.Server object at 0x102b0df70>
           │       └ <function run at 0x102b6f790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1054950c0>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1054e3fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1055be5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1054e3fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1055cea30>
          └ <fastapi.applications.FastAPI object at 0x1055be5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1055c14c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1055ce9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1055cea30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1055c14c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1055ce9a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1055ce9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055c13a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1055ce940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1055ce9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055c13a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1055be700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1055ce940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055c13a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1049ce940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1055c13a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1055be1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1055ca790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1055be4c0>
                     └ <function get_request_handler.<locals>.app at 0x1055ca700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1049ae5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x1054aac70>}
                 │         └ <function bank_types at 0x105096160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1055c8f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 69, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}, {...
            └ <function list_to_tree at 0x105089b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 7, in list_to_tree
    res.setdefault(v["id"], {**v, "key": "/".join(v["key"])}
    │   │          │           │                  └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          │           └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   │          └ {'id': '7a756ca8-83ca-47aa-96f0-385bc82ba7af', 'type': 'OT01', 'name': '本社01', 'parent_id': None, 'key': [0], 'depth': 1}
    │   └ <method 'setdefault' of 'dict' objects>
    └ {}

TypeError: sequence item 0: expected str instance, int found

2023-12-19 17:11:58.890 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:59194 - "GET /test HTTP/1.1" 500
2023-12-19 17:13:15.182 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:13:15.284 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:13:15.285 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:13:15.285 | INFO     | uvicorn.server:serve:86 - Finished server process [26724]
2023-12-19 17:13:15.767 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:13:16.777 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:13:16.879 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:13:16.879 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:13:16.880 | INFO     | uvicorn.server:serve:86 - Finished server process [26788]
2023-12-19 17:13:17.281 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:13:19.885 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[0] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, array_append(key, array_length(key, 1)) as key, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:13:19.940 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:59544 - "GET /test HTTP/1.1" 200
2023-12-19 17:15:01.701 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:15:01.804 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:15:01.805 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:15:01.805 | INFO     | uvicorn.server:serve:86 - Finished server process [26797]
2023-12-19 17:15:02.268 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:15:08.639 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:15:08.679 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60078 - "GET /test HTTP/1.1" 200
2023-12-19 17:17:12.910 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:17:13.013 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:17:13.013 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:17:13.014 | INFO     | uvicorn.server:serve:86 - Finished server process [26835]
2023-12-19 17:17:13.470 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:17:30.056 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:17:30.157 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:17:30.158 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:17:30.158 | INFO     | uvicorn.server:serve:86 - Finished server process [26904]
2023-12-19 17:17:30.618 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:20:05.802 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:20:05.908 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:20:05.909 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:20:05.910 | INFO     | uvicorn.server:serve:86 - Finished server process [26923]
2023-12-19 17:22:39.453 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:22:41.046 | ERROR    | app.endpoints.master:bank_types:78 - 'coroutine' object is not subscriptableTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102c799d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1029f7430>
           └ <SpawnProcess name='SpawnProcess-110' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1029eba60>
    └ <SpawnProcess name='SpawnProcess-110' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x102c55b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-110' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-110' parent=96543 started>
    │    └ <function subprocess_started at 0x105a02790>
    └ <SpawnProcess name='SpawnProcess-110' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x102c55f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1059f6d30>
           │       │   └ <uvicorn.server.Server object at 0x102c55f70>
           │       └ <function run at 0x102cb7790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1059ff140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a4ffd0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105b2a610>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a4ffd0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105b3aa60>
          └ <fastapi.applications.FastAPI object at 0x105b2a610>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105b2d4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x105b3aa00>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105b3aa60>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x105b2d4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105b3a9d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x105b3aa00>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105b2d3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105b3a970>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105b3a9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105b2d3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x105b2a730>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105b3a970>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105b2d3a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10480a940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105b2d3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105b2a1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x105b36790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105b2a4c0>
                     └ <function get_request_handler.<locals>.app at 0x105b36700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1047ea5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x105a15ca0>}
                 │         └ <function bank_types at 0x104cd0160>
                 └ <fastapi.dependencies.models.Dependant object at 0x105b34f70>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 68, in bank_types
    data = await common.query_access_orgs(db, "4754b2d5-add2-4b47-9891-dfde3c992635")[0]
                 │      │                 └ <providers.psql_provider.DB object at 0x105a15ca0>
                 │      └ <function query_access_orgs at 0x104cc5940>
                 └ <module 'app.crud.common' from '/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py'>

TypeError: 'coroutine' object is not subscriptable

2023-12-19 17:22:41.067 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62251 - "GET /test HTTP/1.1" 500
2023-12-19 17:22:53.936 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:22:54.038 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:22:54.039 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:22:54.039 | INFO     | uvicorn.server:serve:86 - Finished server process [27018]
2023-12-19 17:22:54.470 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:22:56.251 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:22:56.277 | ERROR    | app.endpoints.master:bank_types:78 - NoneTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1046ad9d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10442b430>
           └ <SpawnProcess name='SpawnProcess-111' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10441fa60>
    └ <SpawnProcess name='SpawnProcess-111' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104689b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-111' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-111' parent=96543 started>
    │    └ <function subprocess_started at 0x106b06790>
    └ <SpawnProcess name='SpawnProcess-111' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x104689f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x106afad30>
           │       │   └ <uvicorn.server.Server object at 0x104689f70>
           │       └ <function run at 0x1046eb790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x106b03140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x106b53fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106c2e5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x106b53fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x106c3ea30>
          └ <fastapi.applications.FastAPI object at 0x106c2e5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106c324c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x106c3e9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x106c3ea30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106c324c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x106c3e9a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x106c3e9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106c323a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x106c3e940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x106c3e9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106c323a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x106c2e700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x106c3e940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106c323a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10623e940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x106c323a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x106c2e1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x106c3a790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x106c2e4c0>
                     └ <function get_request_handler.<locals>.app at 0x106c3a700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10621e5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x106b1ac70>}
                 │         └ <function bank_types at 0x106704160>
                 └ <fastapi.dependencies.models.Dependant object at 0x106c38f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 74, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '4754b2d5-add2-4b47-9891-dfde3c992635', 'type': 'OT02', 'name': '東京エリア', 'parent_id': '7a756ca8-83ca-47aa-96f0-385bc8...
            └ <function list_to_tree at 0x1066f9b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 11, in list_to_tree
    return res[node_key]["children"]
           │   └ None
           └ {'4754b2d5-add2-4b47-9891-dfde3c992635': {'id': '4754b2d5-add2-4b47-9891-dfde3c992635', 'type': 'OT02', 'name': '東京エリア', 'par...

KeyError: None

2023-12-19 17:22:56.301 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62317 - "GET /test HTTP/1.1" 500
2023-12-19 17:23:28.412 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:23:28.514 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:23:28.514 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:23:28.514 | INFO     | uvicorn.server:serve:86 - Finished server process [27027]
2023-12-19 17:23:28.895 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:23:51.305 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:23:51.407 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:23:51.408 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:23:51.408 | INFO     | uvicorn.server:serve:86 - Finished server process [27042]
2023-12-19 17:23:51.795 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:23:57.560 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:23:57.662 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:23:57.662 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:23:57.663 | INFO     | uvicorn.server:serve:86 - Finished server process [27054]
2023-12-19 17:23:58.047 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:24:00.093 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:24:00.138 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:62587 - "GET /test HTTP/1.1" 200
2023-12-19 17:26:08.748 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:26:08.849 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:26:08.850 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:26:08.850 | INFO     | uvicorn.server:serve:86 - Finished server process [27064]
2023-12-19 17:26:09.270 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:26:10.794 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:26:10.829 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:63124 - "GET /test HTTP/1.1" 200
2023-12-19 17:34:13.177 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:34:13.280 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:34:13.280 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:34:13.280 | INFO     | uvicorn.server:serve:86 - Finished server process [27128]
2023-12-19 17:34:13.771 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:34:15.286 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:34:15.388 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:34:15.389 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:34:15.389 | INFO     | uvicorn.server:serve:86 - Finished server process [27331]
2023-12-19 17:34:15.791 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:34:26.929 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:34:27.031 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:34:27.031 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:34:27.032 | INFO     | uvicorn.server:serve:86 - Finished server process [27338]
2023-12-19 17:36:44.932 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:37:23.003 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:37:23.106 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:37:23.106 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:37:23.107 | INFO     | uvicorn.server:serve:86 - Finished server process [27399]
2023-12-19 17:37:23.568 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:37:35.122 | ERROR    | app.endpoints.master:bank_types:75 - 'coroutine' object is not subscriptableTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x10103d9d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100dbb430>
           └ <SpawnProcess name='SpawnProcess-121' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100dafa60>
    └ <SpawnProcess name='SpawnProcess-121' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101019b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-121' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-121' parent=96543 started>
    │    └ <function subprocess_started at 0x103496790>
    └ <SpawnProcess name='SpawnProcess-121' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101019f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x10348ad30>
           │       │   └ <uvicorn.server.Server object at 0x101019f70>
           │       └ <function run at 0x10107b790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x103493140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1034e0fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1035bf5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1034e0fa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1035cea30>
          └ <fastapi.applications.FastAPI object at 0x1035bf5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1035c44c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1035ce9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1035cea30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1035c44c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1035ce9a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1035ce9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1035c43a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1035ce940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1035ce9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1035c43a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1035bf700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1035ce940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1035c43a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102bce940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1035c43a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1035bf1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1035ca790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1035bf4c0>
                     └ <function get_request_handler.<locals>.app at 0x1035ca700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102bae5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x1034aac70>}
                 │         └ <function bank_types at 0x103094160>
                 └ <fastapi.dependencies.models.Dependant object at 0x1035c8f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 67, in bank_types
    data = await common.query_access_orgs(db, "7a756ca8-83ca-47aa-96f0-385bc82ba7af")[0]
                 │      │                 └ <providers.psql_provider.DB object at 0x1034aac70>
                 │      └ <function query_access_orgs at 0x103089940>
                 └ <module 'app.crud.common' from '/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/crud/common.py'>

TypeError: 'coroutine' object is not subscriptable

2023-12-19 17:37:35.141 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:49739 - "GET /test HTTP/1.1" 500
2023-12-19 17:37:53.869 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 17:37:53.971 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 17:37:53.972 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 17:37:53.972 | INFO     | uvicorn.server:serve:86 - Finished server process [27417]
2023-12-19 17:37:54.448 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 17:37:56.467 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 17:37:56.514 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:49834 - "GET /test HTTP/1.1" 200
2023-12-19 19:19:00.988 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:19:01.092 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:19:01.094 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:19:01.094 | INFO     | uvicorn.server:serve:86 - Finished server process [27434]
2023-12-19 19:19:01.583 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:22:06.012 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id, ARRAY[id] AS key, 1 AS depth FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id, parents.key || child.id, parents.depth + 1 AS depth  FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 19:22:06.036 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64221 - "GET /test HTTP/1.1" 200
2023-12-19 19:35:38.280 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:35:38.383 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:35:38.383 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:35:38.383 | INFO     | uvicorn.server:serve:86 - Finished server process [29270]
2023-12-19 19:35:38.822 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:36:00.900 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:36:01.002 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:36:01.003 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:36:01.003 | INFO     | uvicorn.server:serve:86 - Finished server process [29612]
2023-12-19 19:36:01.507 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:36:13.235 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:36:13.337 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:36:13.337 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:36:13.337 | INFO     | uvicorn.server:serve:86 - Finished server process [29626]
2023-12-19 19:36:13.740 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:36:25.872 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:36:25.973 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:36:25.973 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:36:25.974 | INFO     | uvicorn.server:serve:86 - Finished server process [29635]
2023-12-19 19:36:26.427 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:41:03.172 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:41:03.275 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:41:03.275 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:41:03.275 | INFO     | uvicorn.server:serve:86 - Finished server process [29644]
2023-12-19 19:41:03.716 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:42:33.313 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:42:33.416 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:42:33.416 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:42:33.416 | INFO     | uvicorn.server:serve:86 - Finished server process [29713]
2023-12-19 19:42:33.796 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:44:58.453 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:44:58.555 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:44:58.556 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:44:58.556 | INFO     | uvicorn.server:serve:86 - Finished server process [29742]
2023-12-19 19:44:59.021 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:45:36.441 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:45:36.543 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:45:36.543 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:45:36.543 | INFO     | uvicorn.server:serve:86 - Finished server process [29786]
2023-12-19 19:45:36.987 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:48:44.256 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:48:44.359 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:48:44.359 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:48:44.359 | INFO     | uvicorn.server:serve:86 - Finished server process [29807]
2023-12-19 19:48:44.806 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:51:25.746 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:51:25.849 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:51:25.850 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:51:25.850 | INFO     | uvicorn.server:serve:86 - Finished server process [29969]
2023-12-19 19:51:26.308 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:51:54.029 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:51:54.131 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:51:54.132 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:51:54.132 | INFO     | uvicorn.server:serve:86 - Finished server process [30022]
2023-12-19 19:51:54.541 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:54:25.785 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:54:25.888 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:54:25.889 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:54:25.890 | INFO     | uvicorn.server:serve:86 - Finished server process [30036]
2023-12-19 19:54:26.358 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:54:51.536 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:54:51.639 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:54:51.640 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:54:51.640 | INFO     | uvicorn.server:serve:86 - Finished server process [30094]
2023-12-19 19:54:52.091 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 19:55:45.287 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 19:55:45.390 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 19:55:45.392 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 19:55:45.393 | INFO     | uvicorn.server:serve:86 - Finished server process [30108]
2023-12-19 19:55:45.794 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:01:11.977 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:01:12.080 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:01:12.081 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:01:12.081 | INFO     | uvicorn.server:serve:86 - Finished server process [30136]
2023-12-19 20:01:12.541 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:01:46.739 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:01:46.840 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:01:46.841 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:01:46.841 | INFO     | uvicorn.server:serve:86 - Finished server process [30236]
2023-12-19 20:01:47.309 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:02:12.579 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:02:12.682 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:02:12.685 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:02:12.686 | INFO     | uvicorn.server:serve:86 - Finished server process [30253]
2023-12-19 20:02:13.149 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:02:43.907 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:02:44.009 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:02:44.009 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:02:44.010 | INFO     | uvicorn.server:serve:86 - Finished server process [30265]
2023-12-19 20:02:44.399 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:02:51.662 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
2023-12-19 20:02:51.669 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:02:51.674 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:58861 - "GET /test HTTP/1.1" 200
2023-12-19 20:03:07.879 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:03:07.981 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:03:07.983 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:03:07.984 | INFO     | uvicorn.server:serve:86 - Finished server process [30279]
2023-12-19 20:03:08.377 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:03:15.969 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:03:16.071 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:03:16.072 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:03:16.072 | INFO     | uvicorn.server:serve:86 - Finished server process [30296]
2023-12-19 20:03:16.490 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:05:53.960 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:05:54.063 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:05:54.064 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:05:54.064 | INFO     | uvicorn.server:serve:86 - Finished server process [30303]
2023-12-19 20:05:54.524 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:06:33.897 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:06:33.999 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:06:33.999 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:06:34.000 | INFO     | uvicorn.server:serve:86 - Finished server process [30365]
2023-12-19 20:06:34.509 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:08:45.904 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:08:46.008 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:08:46.010 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:08:46.011 | INFO     | uvicorn.server:serve:86 - Finished server process [30404]
2023-12-19 20:08:46.481 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:09:02.158 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:09:02.261 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:09:02.262 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:09:02.262 | INFO     | uvicorn.server:serve:86 - Finished server process [30486]
2023-12-19 20:09:02.670 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:10:03.886 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:10:03.989 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:10:03.990 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:10:03.990 | INFO     | uvicorn.server:serve:86 - Finished server process [30498]
2023-12-19 20:10:04.460 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:11:03.777 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:11:03.881 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:11:03.882 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:11:03.882 | INFO     | uvicorn.server:serve:86 - Finished server process [30543]
2023-12-19 20:11:04.349 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:11:23.160 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:11:23.262 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:11:23.263 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:11:23.263 | INFO     | uvicorn.server:serve:86 - Finished server process [30566]
2023-12-19 20:11:23.743 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:11:43.077 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:11:43.180 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:11:43.181 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:11:43.181 | INFO     | uvicorn.server:serve:86 - Finished server process [30591]
2023-12-19 20:11:43.572 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:14:03.647 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:14:03.750 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:14:03.755 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:14:03.756 | INFO     | uvicorn.server:serve:86 - Finished server process [30613]
2023-12-19 20:14:04.231 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:14:34.920 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:14:35.021 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:14:35.022 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:14:35.022 | INFO     | uvicorn.server:serve:86 - Finished server process [30674]
2023-12-19 20:14:35.517 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:14:59.780 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:14:59.882 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:14:59.883 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:14:59.883 | INFO     | uvicorn.server:serve:86 - Finished server process [30700]
2023-12-19 20:15:00.302 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:16:19.426 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:16:19.529 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:16:19.531 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:16:19.531 | INFO     | uvicorn.server:serve:86 - Finished server process [30711]
2023-12-19 20:16:19.988 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:16:32.820 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:16:32.921 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:16:32.922 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:16:32.922 | INFO     | uvicorn.server:serve:86 - Finished server process [30759]
2023-12-19 20:16:33.318 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:18:05.579 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:18:05.683 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:18:05.683 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:18:05.684 | INFO     | uvicorn.server:serve:86 - Finished server process [30781]
2023-12-19 20:18:06.122 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:18:09.006 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
2023-12-19 20:18:09.012 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:18:09.019 | ERROR    | app.endpoints.master:bank_types:78 - NoneTraceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1033959d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x103113430>
           └ <SpawnProcess name='SpawnProcess-157' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103107a60>
    └ <SpawnProcess name='SpawnProcess-157' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103371b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-157' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-157' parent=96543 started>
    │    └ <function subprocess_started at 0x1057ee790>
    └ <SpawnProcess name='SpawnProcess-157' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103371f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1057e2d30>
           │       │   └ <uvicorn.server.Server object at 0x103371f70>
           │       └ <function run at 0x1033d3790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x1057ec140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105838f40>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105916130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1059165b0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105838f40>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105916130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x105916130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105926a00>
          └ <fastapi.applications.FastAPI object at 0x1059165b0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1059184c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1059269a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x105926a00>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1059184c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105926970>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1059269a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1059183a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105926910>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x105926970>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1059183a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1059166d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x105926910>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1059183a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104f26940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x1059183a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1059161...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x105922790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1059164c0>
                     └ <function get_request_handler.<locals>.app at 0x105922700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104f065e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x105802c40>}
                 │         └ <function bank_types at 0x1053ec160>
                 └ <fastapi.dependencies.models.Dependant object at 0x105920f10>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 74, in bank_types
    content=list_to_tree(data)
            │            └ [{'id': '7c56b92c-2210-4243-b5ce-a0347fe3cb64', 'type': 'OT03', 'name': '東京支店02', 'parent_id': '4754b2d5-add2-4b47-9891-dfde3...
            └ <function list_to_tree at 0x1053e1b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 10, in list_to_tree
    return res[node_key]["children"]
           │   └ None
           └ {'7c56b92c-2210-4243-b5ce-a0347fe3cb64': {'id': '7c56b92c-2210-4243-b5ce-a0347fe3cb64', 'type': 'OT03', 'name': '東京支店02', 'pa...

KeyError: None

2023-12-19 20:18:09.044 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64082 - "GET /test HTTP/1.1" 500
2023-12-19 20:18:24.238 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:18:24.339 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:18:24.340 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:18:24.340 | INFO     | uvicorn.server:serve:86 - Finished server process [30824]
2023-12-19 20:18:24.812 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:18:26.624 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
2023-12-19 20:18:26.628 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:18:26.634 | ERROR    | app.endpoints.master:bank_types:78 - 'children'Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1009959d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100713430>
           └ <SpawnProcess name='SpawnProcess-158' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100707a60>
    └ <SpawnProcess name='SpawnProcess-158' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x100971b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-158' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-158' parent=96543 started>
    │    └ <function subprocess_started at 0x103442790>
    └ <SpawnProcess name='SpawnProcess-158' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x100971f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x103436d30>
           │       │   └ <uvicorn.server.Server object at 0x100971f70>
           │       └ <function run at 0x1009d3790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x103440140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10348cf40>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x10356b5b0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10348cf40>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10357aa00>
          └ <fastapi.applications.FastAPI object at 0x10356b5b0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10356e4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10357a9a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10357aa00>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10356e4c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10357a970>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10357a9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10356e3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10357a910>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10357a970>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10356e3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10356b6d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x10357a910>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10356e3a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10294e940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x10356e3a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x10356b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x103576790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10356b4c0>
                     └ <function get_request_handler.<locals>.app at 0x103576700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10292e5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x103456c40>}
                 │         └ <function bank_types at 0x102f14160>
                 └ <fastapi.dependencies.models.Dependant object at 0x103574f10>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 74, in bank_types
    content=list_to_tree(data, "7c56b92c-2210-4243-b5ce-a0347fe3cb64")
            │            └ [{'id': '7c56b92c-2210-4243-b5ce-a0347fe3cb64', 'type': 'OT03', 'name': '東京支店02', 'parent_id': '4754b2d5-add2-4b47-9891-dfde3...
            └ <function list_to_tree at 0x102f09b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 10, in list_to_tree
    return res[node_key]["children"]
           │   └ '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
           └ {'7c56b92c-2210-4243-b5ce-a0347fe3cb64': {'id': '7c56b92c-2210-4243-b5ce-a0347fe3cb64', 'type': 'OT03', 'name': '東京支店02', 'pa...

KeyError: 'children'

2023-12-19 20:18:26.660 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64163 - "GET /test HTTP/1.1" 500
2023-12-19 20:19:26.240 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:19:26.343 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:19:26.344 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:19:26.344 | INFO     | uvicorn.server:serve:86 - Finished server process [30837]
2023-12-19 20:19:26.791 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:19:34.549 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
2023-12-19 20:19:34.553 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:19:34.559 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64485 - "GET /test HTTP/1.1" 200
2023-12-19 20:20:01.298 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:20:01.400 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:20:01.401 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:20:01.401 | INFO     | uvicorn.server:serve:86 - Finished server process [30860]
2023-12-19 20:20:01.884 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:20:04.078 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
2023-12-19 20:20:04.083 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE parent_id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:20:04.089 | ERROR    | app.endpoints.master:bank_types:78 - '7c56b92c-2210-4243-b5ce-a0347fe3cb64'Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104a499d0>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1047c7430>
           └ <SpawnProcess name='SpawnProcess-160' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1047bba60>
    └ <SpawnProcess name='SpawnProcess-160' parent=96543 started>

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104a25b20>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-160' parent=96543 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-160' parent=96543 started>
    │    └ <function subprocess_started at 0x107a02790>
    └ <SpawnProcess name='SpawnProcess-160' parent=96543 started>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x104a25f70>>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8000)>]
           │       │   │    └ <function Server.serve at 0x1079f6d30>
           │       │   └ <uvicorn.server.Server object at 0x104a25f70>
           │       └ <function run at 0x104a87790>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/async...

  File "/opt/homebrew/Cellar/python@3.9/3.9.18_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x107a00140>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>

  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107a4cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b130>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x107b2b5e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x107a4cfa0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b130>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b130>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107b3aa30>
          └ <fastapi.applications.FastAPI object at 0x107b2b5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107b304c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107b3a9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107b3aa30>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107b304c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107b3a9a0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x107b3a9d0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x107b303a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x107b3a940>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107b3a9a0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x107b303a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x107b2b700>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x107b3a940>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x107b303a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10670e940>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x107b303a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x107b2b1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x107b37790>
          └ APIRoute(path='/test', name='bank_types', methods=['GET'])
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x107b2b4c0>
                     └ <function get_request_handler.<locals>.app at 0x107b37700>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1065ba5e0>
  File "/Users/ryu/.local/share/virtualenvs/loan-ledger-if-v4-_WxevXHE/lib/python3.9/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <providers.psql_provider.DB object at 0x107a16c70>}
                 │         └ <function bank_types at 0x106cd4160>
                 └ <fastapi.dependencies.models.Dependant object at 0x107b34f40>

> File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/app/endpoints/master.py", line 74, in bank_types
    content=list_to_tree(data, "7c56b92c-2210-4243-b5ce-a0347fe3cb64")
            │            └ []
            └ <function list_to_tree at 0x106cc9b80>

  File "/Users/ryu/Desktop/loan-ledger-v4/loan-ledger-if-v4/utils/tree_parse.py", line 10, in list_to_tree
    return res[node_key]
           │   └ '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
           └ {}

KeyError: '7c56b92c-2210-4243-b5ce-a0347fe3cb64'

2023-12-19 20:20:04.119 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:64617 - "GET /test HTTP/1.1" 500
2023-12-19 20:20:42.925 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:20:43.027 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:20:43.028 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:20:43.028 | INFO     | uvicorn.server:serve:86 - Finished server process [30887]
2023-12-19 20:20:43.499 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:21:27.208 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:21:27.310 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:21:27.311 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:21:27.311 | INFO     | uvicorn.server:serve:86 - Finished server process [30925]
2023-12-19 20:21:27.823 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:21:45.595 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
2023-12-19 20:21:45.600 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7c56b92c-2210-4243-b5ce-a0347fe3cb64'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:21:45.604 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:65034 - "GET /test HTTP/1.1" 200
2023-12-19 20:22:14.992 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:22:15.094 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:22:15.094 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:22:15.094 | INFO     | uvicorn.server:serve:86 - Finished server process [30939]
2023-12-19 20:22:15.538 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:22:17.658 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
2023-12-19 20:22:17.682 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:22:17.708 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:65169 - "GET /test HTTP/1.1" 200
2023-12-19 20:23:09.764 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:23:09.866 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:23:09.867 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:23:09.868 | INFO     | uvicorn.server:serve:86 - Finished server process [30967]
2023-12-19 20:23:10.284 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:23:13.322 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
2023-12-19 20:23:13.326 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:23:13.332 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:65398 - "GET /test HTTP/1.1" 200
2023-12-19 20:24:50.778 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:24:50.879 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:24:50.880 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:24:50.880 | INFO     | uvicorn.server:serve:86 - Finished server process [30990]
2023-12-19 20:24:51.277 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:26:49.510 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:26:49.613 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:26:49.614 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:26:49.614 | INFO     | uvicorn.server:serve:86 - Finished server process [31025]
2023-12-19 20:26:50.074 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:28:19.507 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:28:19.610 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:28:19.610 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:28:19.611 | INFO     | uvicorn.server:serve:86 - Finished server process [31071]
2023-12-19 20:28:20.065 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:28:35.659 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:28:35.761 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:28:35.761 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:28:35.762 | INFO     | uvicorn.server:serve:86 - Finished server process [31114]
2023-12-19 20:28:36.197 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:29:11.997 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:29:12.099 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:29:12.100 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:29:12.100 | INFO     | uvicorn.server:serve:86 - Finished server process [31127]
2023-12-19 20:29:12.526 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:30:15.221 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:30:15.322 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:30:15.323 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:30:15.324 | INFO     | uvicorn.server:serve:86 - Finished server process [31143]
2023-12-19 20:30:15.768 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:30:19.100 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:30:19.201 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:30:19.202 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:30:19.202 | INFO     | uvicorn.server:serve:86 - Finished server process [31167]
2023-12-19 20:30:19.596 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:30:22.630 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
2023-12-19 20:30:22.634 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '4754b2d5-add2-4b47-9891-dfde3c992635'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:30:22.639 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:50776 - "GET /test HTTP/1.1" 200
2023-12-19 20:31:35.065 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-19 20:31:35.167 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-19 20:31:35.168 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-19 20:31:35.168 | INFO     | uvicorn.server:serve:86 - Finished server process [31176]
2023-12-19 20:31:35.647 | INFO     | uvicorn.lifespan.on:startup:60 - Application startup complete.
2023-12-19 20:31:38.036 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
2023-12-19 20:31:38.059 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-19 20:31:38.063 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:51166 - "GET /test HTTP/1.1" 200
2023-12-19 23:17:35.387 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:65508 - "OPTIONS /token HTTP/1.1" 200
2023-12-19 23:17:35.415 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-19 23:17:35.429 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 23:17:35.432 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 23:17:35.434 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-19 23:17:35.448 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-19 23:17:35.456 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:65508 - "POST /token HTTP/1.1" 200
2023-12-20 00:58:33.477 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:59973 - "OPTIONS /token HTTP/1.1" 200
2023-12-20 00:58:33.489 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        password,
        default_role_id
    FROM
        users
    WHERE
        users.email = '001@demo.com';
    
2023-12-20 00:58:33.493 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-20 00:58:33.499 | INFO     | providers.psql_provider:fetch_one:30 - 
    SELECT
        id,
        email,
        name,
        default_role_id
    FROM
        users
    WHERE
        users.id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-20 00:58:33.500 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        roles.id,
        roles.type,
        orgs.name
    FROM
        roles
    JOIN
        users
        ON
        users.id = roles.user_id
    JOIN
        orgs
        ON
        orgs.id = roles.org_id
    WHERE
        roles.user_id = '051260d6-5952-4a97-b37a-4630f09937f3';
    
2023-12-20 00:58:33.502 | INFO     | providers.psql_provider:fetch_all:39 - 
    SELECT
        code,
        name
    FROM
        permissions
    JOIN
        role_permission_rels
        ON
        role_permission_rels.permission_code = permissions.code
    JOIN
        roles
        ON
        roles.id = role_permission_rels.role_id
    WHERE
        roles.id = 'e2fa169b-f1d0-4564-b970-e6de28475a8d';
    
2023-12-20 00:58:33.504 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:59973 - "POST /token HTTP/1.1" 200
2023-12-20 10:33:55.197 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60863 - "OPTIONS /orgs HTTP/1.1" 200
2023-12-20 10:33:55.199 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60864 - "OPTIONS /orgs HTTP/1.1" 200
2023-12-20 10:33:55.200 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60863 - "GET /orgs HTTP/1.1" 404
2023-12-20 10:33:55.201 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:60863 - "GET /orgs HTTP/1.1" 404
2023-12-20 10:36:17.052 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61443 - "OPTIONS /test HTTP/1.1" 200
2023-12-20 10:36:17.053 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61444 - "OPTIONS /test HTTP/1.1" 200
2023-12-20 10:36:17.074 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
2023-12-20 10:36:17.078 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-20 10:36:17.085 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61443 - "GET /test HTTP/1.1" 200
2023-12-20 10:36:17.099 | INFO     | providers.psql_provider:fetch_value:48 - SELECT id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
2023-12-20 10:36:17.101 | INFO     | providers.psql_provider:fetch_all:39 - 
    WITH RECURSIVE parents AS (
        SELECT id, type, name, parent_id FROM orgs WHERE id = '7a756ca8-83ca-47aa-96f0-385bc82ba7af'
        UNION ALL 
        SELECT child.id, child.type, child.name, child.parent_id FROM orgs as child INNER JOIN parents ON parents.id = child.parent_id
    )
    SELECT parents.* FROM parents;
    
2023-12-20 10:36:17.109 | INFO     | uvicorn.protocols.http.httptools_impl:send:496 - 127.0.0.1:61443 - "GET /test HTTP/1.1" 200
2023-12-20 10:36:45.844 | INFO     | uvicorn.server:shutdown:264 - Shutting down
2023-12-20 10:36:45.945 | INFO     | uvicorn.lifespan.on:shutdown:65 - Waiting for application shutdown.
2023-12-20 10:36:45.946 | INFO     | uvicorn.lifespan.on:shutdown:76 - Application shutdown complete.
2023-12-20 10:36:45.946 | INFO     | uvicorn.server:serve:86 - Finished server process [31206]
